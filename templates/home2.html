<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
      
      XplagiaX - MarkTrack</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
          --primary-color: #191919;
          --primary: #1621ff;
          --white: #FFFFFF;
          --sidebar-primary-hover: #EBEFFD;
          --sidebar-background: #ffffff;
          --background: #bbc7d4;
          --text: #64748b;
          --text-dark: #1e293b;
          --text-link: #2c36ff;
          --expand-button: #222dff;
          --logout: #FA7575;
          --search-background: #EBEFFD;
          --card-bg: #ffffff;
          --border: rgba(0, 0, 0, 0.08);
          --shadow: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
          --shadow-hover: 0 4px 6px rgba(0, 0, 0, 0.1), 0 2px 4px rgba(0, 0, 0, 0.06);
          --transition-fast: 0.2s ease;
          --transition-normal: 0.3s ease;
          --iconprimary: #1621ff;
          --iconsecondary: #007AFF;
          --icontext-color: #333;
          --navtext: #646FA7;
          --navtext-link: #2c36ff;
          --danger: #ef4444;
        }

        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }

        html, body {
          height: 100%;
          overflow: hidden;
        }

        body {
          font-family: 'Inter', sans-serif;
          font-size: 14px;
          background: var(--background);
          color: var(--text-dark);
          line-height: 1.5;
          display: flex;
          flex-direction: column;
        }

        /* Sidebar Styles */
        .sidebar {
          position: fixed;
          top: 0;
          left: 0;
          min-height: 100vh;
          height: 100%;
          padding: 1.5rem 1rem;
          border-radius: 0 1.1rem 1.1rem 0;
          user-select: none;
          max-width: 66rem;
          min-width: 4rem;
          display: flex;
          color: var(--white);
          flex-direction: column;
          background: var(--sidebar-background);
          transition: all 0.3s ease-in-out;
          z-index: 1000;
        }

        body.collapsed .sidebar {
          max-width: 5rem;
        }

        body.collapsed .hide {
          position: absolute;
          visibility: hidden;
        }

        .sidebar-top-wrapper {
          display: flex;
          background: var(--primary-color-light);
        }

        .sidebar-top {
          position: relative;
          display: flex;
          align-items: start;
          justify-content: center;
          flex-direction: column;
          overflow: hidden;
          height: 4rem;
          padding-bottom: 1rem;
        }

        .navbar-brand {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 1.0rem;
            font-weight: 600;
            color: var(--iconprimary);
            text-decoration: none;
        }

        .app-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--iconprimary) 0%, var(--iconsecondary) 100%);
            border-radius: 9px;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        .icon-svg {
            width: 22px;
            height: 22px;
            color: white;
            z-index: 1;
        }

        .brand-text {
            line-height: 1;
            color: var(--icontext-color);
            font-weight: 500;
            font-size: 24px;
        }

        .sidebar-links {
          margin-top: 1rem;
        }

        .sidebar-links ul {
          list-style-type: none;
          position: relative;
          display: flex;
          row-gap: 0.5rem;
          flex-direction: column;
        }

        .sidebar-links li {
          color: var(--text);
          min-width: 3rem;
        }

        .sidebar-links li svg {
          stroke: var(--text);
          width: 1.4rem;
          height: 1.4rem;
          min-width: 1.75rem;
        }

        .sidebar-links li a:hover {
          background: var(--sidebar-primary-hover);
          color: var(--text-link);
        }

        .sidebar-links li a:hover svg {
          stroke: var(--text-link);
        }

        .sidebar-links li a {
          color: var(--navtext);
          width: 100%;
          padding-left: 0.6rem;
          font-size: 1.0rem;
          display: flex;
          gap: 0.75rem;
          border-radius: 0.75rem;
          justify-content: start;
          align-items: center;
          min-height: 3.25rem;
          text-decoration: none;
          transition: background 0.2s ease-in-out;
        }

        .sidebar-links li a .link {
          overflow: hidden;
          white-space: nowrap;
          animation: fadeIn 0.2s ease-in-out;
        }

        .sidebar-links .active {
          text-decoration: none;
          background: var(--sidebar-primary-hover);
          color: var(--navtext-link);
        }

        .sidebar-links .active svg {
          stroke: var(--navtext-link);
        }

        .expand-btn {
          position: absolute;
          display: grid;
          place-items: center;
          cursor: pointer;
          background: var(--expand-button);
          z-index: 2;
          right: -1rem;
          width: 2.25rem;
          height: 2.25rem;
          border: none;
          border-radius: 50%;
        }

        .expand-btn svg {
          transform: rotate(-180deg);
          stroke: var(--white);
          width: 1.25rem;
          height: 1.25rem;
        }

        body.collapsed .expand-btn svg {
          transform: rotate(-360deg);
        }

        /* Header */
        .header {
          padding: 1rem 0;
          position: sticky;
          top: 0;
          z-index: 100;
          backdrop-filter: blur(10px);

          flex-shrink: 0;
        }

        .header-container {
          max-width: 1200px;
          margin: 0 auto;
          padding: 0 2rem;
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .breadcrumb {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          color: var(--text);
          font-size: 0.9rem;
        }

        .breadcrumb a {
          color: var(--text-link);
          text-decoration: none;
        }

        .header-actions {
          display: flex;
          align-items: center;
          gap: 1rem;
        }

        .upload-btn, .trash-btn {
          display: flex;
          align-items: center;
          gap: 0.5rem;
          padding: 0.5rem 1.2rem;

          color: var(--primary);
          border: none;
          border-radius: 0.5rem;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.3s ease;

        }

        .trash-btn {
          color: var(--danger);
        }

        .upload-btn:hover, .trash-btn:hover {
          transform: translateY(-1px);
          box-shadow: 0 4px 8px rgba(22, 33, 255, 0.3);
        }

        /* Main Container */
        .main-container {
          max-width: 1200px;
          width: 60%;
          margin: 0 auto;
          padding: 2rem;
          flex: 1;
          overflow-y: auto;
          overflow-x: hidden;
        }

        /* Section Headers */
        .section-header {
          display: flex;
          align-items: center;
          justify-content: space-between;
          margin-bottom: 1.5rem;
        }

        .section-title {
          font-size: 1.25rem;
          font-weight: 600;
          color: var(--text-dark);
        }

        .section-actions {
          display: flex;
          gap: 0.5rem;
        }

        .icon-btn {
          padding: 0.5rem;
          background: transparent;
          border: none;
          cursor: pointer;
          border-radius: 0.375rem;
          color: var(--text);
          transition: all 0.2s ease;
        }

        .icon-btn:hover {
          background: var(--sidebar-primary-hover);
          color: var(--primary);
        }

        /* My Files Section */
        .my-files-section {
          margin-bottom: 2rem;
        }

        .files-container {
          display: flex;
          gap: 1rem;
          align-items: flex-start;
        }

        .new-doc-column {
          flex-shrink: 0;
        }

        .files-grid {
          display: flex;
          flex-wrap: wrap;
          gap: 0.75rem;
          flex: 1;
        }

        .file-card {
          background: var(--white);
          border: 1px solid var(--border);
          border-radius: 0.5rem;
          padding: 0.75rem;
          text-align: center;
          cursor: pointer;
          transition: all 0.2s ease;
          position: relative;
          width: 140px;
        }

        .file-card:hover {
          transform: translateY(-1px);
          box-shadow: var(--shadow-hover);
          border-color: var(--primary);
        }

        .file-icon-large {
          width: 2.5rem;
          height: 2.5rem;
          margin: 0 auto 0.5rem;
          border-radius: 0.375rem;
          display: flex;
          align-items: center;
          justify-content: center;
        }

        .doc-file { background: #4285f4; color: white; }

        .file-name {
          font-size: 0.8rem;
          font-weight: 500;
          color: var(--text-dark);
          margin-bottom: 0.25rem;
          line-height: 1.2;
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }

        .file-size {
          font-size: 0.7rem;
          color: var(--text);
        }

        .file-menu-btn {
          position: absolute;
          top: 0.5rem;
          right: 0.5rem;
          background: white;
          border: 1px solid var(--border);
          border-radius: 0.25rem;
          padding: 0.25rem;
          cursor: pointer;
          opacity: 0;
          transition: opacity 0.2s ease;
          z-index: 10;
        }

        .file-card:hover .file-menu-btn {
          opacity: 1;
        }

        .file-menu-btn:hover {
          background: var(--sidebar-primary-hover);
        }

        /* Dropdown Menu */
        .dropdown-menu {
          position: absolute;
          top: 2rem;
          right: 0;
          background: white;
          border: 1px solid var(--border);
          border-radius: 0.5rem;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
          min-width: 150px;
          z-index: 1000;
          display: none;
        }

        .dropdown-menu.show {
          display: block;
          animation: slideDown 0.2s ease;
        }

        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .dropdown-item {
          padding: 0.75rem 1rem;
          cursor: pointer;
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-size: 0.875rem;
          color: var(--text-dark);
          transition: background 0.2s ease;
          border: none;
          background: none;
          width: 100%;
          text-align: left;
        }

        .dropdown-item:hover {
          background: var(--sidebar-primary-hover);
        }

        .dropdown-item.danger {
          color: var(--danger);
        }

        .dropdown-item.danger:hover {
          background: rgba(239, 68, 68, 0.1);
        }

        /* Shared Files Section */
        .shared-section {
          margin-bottom: 2rem;
          animation: fadeInUp 0.4s ease forwards 0.1s;
          opacity: 0;
        }

        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .classroom-grid {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
          gap: 1rem;
        }

        .classroom-card {
          background: var(--white);
          border: 1px solid var(--border);
          border-radius: 0.5rem;
          overflow: hidden;
          cursor: pointer;
          transition: all 0.2s ease;
        }

        .classroom-card:hover {
          transform: translateY(-1px);
          box-shadow: var(--shadow-hover);
        }

        .card-content {
          padding: 1rem;
        }

        .assignment-title {
          font-size: 1rem;
          font-weight: 600;
          color: var(--text-dark);
          margin-bottom: 0.5rem;
          line-height: 1.3;
        }

        .assignment-description {
          font-size: 0.875rem;
          color: var(--text);
          margin-bottom: 1rem;
          line-height: 1.4;
        }

        .assignment-meta {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 1rem;
          font-size: 0.75rem;
          color: var(--text);
        }

        .due-date {
          font-weight: 500;
        }

        .progress-section {
          margin-bottom: 1rem;
        }

        .progress-label {
          font-size: 0.75rem;
          color: var(--text);
          margin-bottom: 0.5rem;
          text-transform: uppercase;
          letter-spacing: 0.025em;
          font-weight: 500;
        }

        .progress-bar {
          width: 100%;
          height: 0.375rem;
          background: #e2e8f0;
          border-radius: 0.1875rem;
          overflow: hidden;
          margin-bottom: 0.5rem;
        }

        .progress-fill {
          height: 100%;
          border-radius: 0.1875rem;
          transition: width 0.3s ease;
          position: relative;
        }

        .progress-blue { background: #3b82f6; }
        .progress-green { background: #10b981; }
        .progress-orange { background: #f59e0b; }
        .progress-purple { background: #8b5cf6; }

        .participants-section {
          display: flex;
          align-items: center;
          justify-content: space-between;
        }

        .participant-avatars {
          display: flex;
          gap: -0.5rem;
        }

        .avatar {
          width: 2rem;
          height: 2rem;
          border-radius: 50%;
          border: 2px solid white;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 0.75rem;
          font-weight: 600;
          color: white;
          margin-left: -0.5rem;
          position: relative;
          z-index: 1;
        }

        .avatar:first-child {
          margin-left: 0;
        }

        .avatar-1 { background: #3b82f6; }
        .avatar-2 { background: #10b981; }
        .avatar-3 { background: #f59e0b; }
        .avatar-4 { background: #8b5cf6; }
        .avatar-5 { background: #ef4444; }

        .more-avatars {
          background: var(--text);
          font-size: 0.625rem;
        }

        .edit-btn {
          padding: 0.25rem;
          background: transparent;
          border: none;
          cursor: pointer;
          color: var(--text);
          border-radius: 0.25rem;
          transition: all 0.2s ease;
        }

        .edit-btn:hover {
          background: var(--sidebar-primary-hover);
          color: var(--primary);
        }

        /* Offcanvas */
        .offcanvas {
          position: fixed;
          top: 0;
          right: -100%;
          width: 350px;
          height: 100vh;
          background: white;
          box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
          z-index: 1050;
          transition: left 0.3s ease;
          display: flex;
          flex-direction: column;
        }

        .offcanvas.show {
          left: 0;
        }

        .offcanvas-header {
          padding: 1.5rem;
          border-bottom: 1px solid var(--border);
          display: flex;
          justify-content: space-between;
          align-items: center;
        }

        .offcanvas-title {
          font-size: 1.25rem;
          font-weight: 600;
          color: var(--text-dark);
        }

        .offcanvas-close {
          background: none;
          border: none;
          font-size: 1.5rem;
          cursor: pointer;
          color: var(--text);
          padding: 0.25rem 0.5rem;
          border-radius: 0.25rem;
          transition: background 0.2s ease;
        }

        .offcanvas-close:hover {
          background: var(--sidebar-primary-hover);
        }

        .offcanvas-body {
          padding: 1.5rem;
          overflow-y: auto;
          flex: 1;
        }

        .offcanvas-backdrop {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(0, 0, 0, 0.5);
          z-index: 1040;
          display: none;
        }

        .offcanvas-backdrop.show {
          display: block;
        }

        .trash-item {
          background: var(--white);
          border: 1px solid var(--border);
          border-radius: 0.5rem;
          padding: 1rem;
          margin-bottom: 1rem;
          transition: all 0.2s ease;
        }

        .trash-item:hover {
          transform: translateY(-1px);
          box-shadow: var(--shadow-hover);
          border-color: var(--primary);
        }
        

        .trash-item-header {
          display: flex;
          justify-content: space-between;
          align-items: start;
          margin-bottom: 0.5rem;
        }

        .trash-item-title {
          font-weight: 600;
          color: var(--text-dark);
          margin-bottom: 0.25rem;
        }

        .trash-item-date {
          font-size: 0.75rem;
          color: var(--text);
        }

        .trash-item-actions {
          display: flex;
          gap: 0.5rem;
          margin-top: 0.75rem;
        }

        .trash-btn-small {
          padding: 0.25rem 0.5rem;
          font-size: 0.75rem;
          border: none;
          border-radius: 0.25rem;
          cursor: pointer;
          transition: all 0.2s ease;
        }

        .btn-restore {
          background: white;
          color: var(--primary);
        }

        .btn-delete-permanent {
          color: var(--danger);
          background: white;
        }

        /* Modal */
        .modal {
          display: none;
          position: fixed;
          z-index: 2000;
          left: 0;
          top: 0;
          width: 100%;
          height: 100%;
          overflow: auto;
          background-color: rgba(0, 0, 0, 0.5);
          animation: fadeIn 0.3s ease;
        }

        .modal.show {
          display: block;
        }

        .modal-content {
          background-color: white;
          margin: 5% auto;
          padding: 2rem;
          border-radius: 0.75rem;
          width: 90%;
          max-width: 500px;
          box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
          animation: slideIn 0.3s ease;
        }

        @keyframes fadeIn {
          from { opacity: 0; }
          to { opacity: 1; }
        }

        @keyframes slideIn {
          from {
            transform: translateY(-50px);
            opacity: 0;
          }
          to {
            transform: translateY(0);
            opacity: 1;
          }
        }

        .close {
          color: var(--text);
          float: right;
          font-size: 28px;
          font-weight: bold;
          cursor: pointer;
          line-height: 1;
        }

        .close:hover {
          color: var(--text-dark);
        }

        .form-group {
          margin-bottom: 1.5rem;
        }

        .form-label {
          display: block;
          margin-bottom: 0.5rem;
          font-weight: 500;
          color: var(--text-dark);
        }

        .form-control {
          width: 100%;
          padding: 0.75rem;
          border: 1px solid var(--border);
          border-radius: 0.5rem;
          font-size: 0.875rem;
          transition: border-color 0.2s ease;
        }

        .form-control:focus {
          outline: none;
          border-color: var(--primary);
        }

        .error-text {
          color: var(--danger);
          font-size: 0.75rem;
          margin-top: 0.25rem;
        }

        .btn {
          padding: 0.75rem 1.5rem;
          border: none;
          border-radius: 0.5rem;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.2s ease;
        }

        .btn-primary {
          background: var(--primary);
          color: white;
        }

        .btn-primary:hover {
          transform: translateY(-1px);
          box-shadow: 0 4px 12px rgba(22, 33, 255, 0.3);
        }

        .btn-secondary {
          background: var(--text);
          color: white;
        }

        .loading {
          display: inline-block;
          width: 14px;
          height: 14px;
          border: 2px solid rgba(255, 255, 255, 0.3);
          border-top-color: white;
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
          to { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 768px) {
          .header-container {
            padding: 0 1rem;
          }

          .main-container {
            padding: 1rem;
          }

          .files-container {
            flex-direction: column;
          }

          .files-grid {
            justify-content: flex-start;
          }

          .classroom-grid {
            grid-template-columns: 1fr;
          }

          .offcanvas {
            width: 90%;
          }
        }

        

        .file-menu-btn {
          position: absolute;
          top: 0.5rem;
          right: 0.5rem;
          background: white;
          border: 1px solid var(--border);
          border-radius: 0.25rem;
          padding: 0.25rem;
          cursor: pointer;
          opacity: 0;
          transition: opacity 0.2s ease;
          z-index: 10;
        }

        .file-card:hover .file-menu-btn {
          opacity: 1;
        }

        .file-menu-btn:hover {
          background: var(--sidebar-primary-hover);
        }


        /* Dropdown Menu */
        .dropdown-menu {
          position: absolute;
          top: 2rem;
          right: 0;
          background: white;
          border: 1px solid var(--border);
          border-radius: 0.5rem;
          box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
          min-width: 150px;
          z-index: 1000;
          display: none;
        }

        .dropdown-menu.show {
          display: block;
          animation: slideDown 0.2s ease;
        }

        @keyframes slideDown {
          from {
            opacity: 0;
            transform: translateY(-10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .dropdown-item {
          padding: 0.75rem 1rem;
          cursor: pointer;
          display: flex;
          align-items: center;
          gap: 0.5rem;
          font-size: 0.875rem;
          color: var(--text-dark);
          transition: background 0.2s ease;
          border: none;
          background: none;
          width: 100%;
          text-align: left;
        }

        .dropdown-item:hover {
          background: var(--sidebar-primary-hover);
        }

        .dropdown-item.danger {
          color: var(--danger);
        }

        .dropdown-item.danger:hover {
          background: rgba(239, 68, 68, 0.1);
        }

        /* Shared Files Section */
        .shared-section {
          margin-bottom: 2rem;
          animation: fadeInUp 0.4s ease forwards 0.1s;
          opacity: 0;
        }

        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

    </style>
</head>
<body class="collapsed">
    <!-- Header -->
    <header class="header">
        <div class="header-container">
            <div>
                <nav class="breadcrumb">
                    <a href="#">XplagiaX</a>
                    <span>/</span>
                    <span>MarkTrack</span>
                </nav>
            </div>
            
            <div class="header-actions">
                <button class="trash-btn" onclick="openTrash()">
                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                    </svg>
                    Trash
                </button>
                <button class="upload-btn" onclick="handleUpload()">
                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
                    </svg>
                    Upload
                </button>
            </div>
        </div>
    </header>

    <!-- Sidebar -->
    <nav class="sidebar">
      <div class="sidebar-top-wrapper">
        <div class="sidebar-top">
          <div class="navbar-brand">
            <div class="app-icon">
                <svg class="icon-svg" viewBox="0 0 16 16" fill="currentColor">
                    <path fill-rule="evenodd" d="M10.854 5.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7.5 7.793l2.646-2.647a.5.5 0 0 1 .708 0"></path>
                    <path d="M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v13.5a.5.5 0 0 1-.777.416L8 13.101l-5.223 2.815A.5.5 0 0 1 2 15.5zm2-1a1 1 0 0 0-1 1v12.566l4.723-2.482a.5.5 0 0 1 .554 0L13 14.566V2a1 1 0 0 0-1-1z"></path>
                </svg>
            </div>
            <span class="brand-text">MarkTrack </span>
        </div>
        </div>
        <button class="expand-btn" type="button">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M6.00979 2.72L10.3565 7.06667C10.8698 7.58 10.8698 8.42 10.3565 8.93333L6.00979 13.28"
              stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round" />
          </svg>
        </button>
      </div>
      <div class="sidebar-links">
        <ul>
          <li>
            <a href="" class="tooltip active">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                <path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5z"/>
              </svg>
              <span class="link">Home</span>
            </a>
          </li>          
        </ul>
      </div>
    </nav>

    <!-- Main Container -->
    <main class="main-container">
        <!-- My Files Section -->
        <section class="my-files-section">
            <div class="section-header">
                <h2 class="section-title">My Documents</h2>
            </div>

            <div class="files-container">
                <!-- New Document Card -->
                <div class="new-doc-column">
                    <div class="file-card" onclick="createNewDocument()" style="border: 2px dashed var(--border);">
                        <div class="file-icon-large" style="background: var(--sidebar-primary-hover); color: var(--primary);">
                            <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
                            </svg>
                        </div>
                        <p class="file-name">New</p>
                    </div>
                </div>

                <!-- Documents Grid -->
                <div class="files-grid" id="documentsListContainer">
             
                </div>
            </div>
        </section>

        <!-- For Beginners Section -->
        <section class="shared-section">
            <div class="section-header">
                <h2 class="section-title">For Beginners (17)</h2>
                <div class="section-actions">
                    <button class="icon-btn" title="Settings">
                        <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                        </svg>
                    </button>
                </div>
            </div>
            
            <div class="classroom-grid">
                <!-- Beginner Assignment 1 -->
                <div class="classroom-card" onclick="openAssignment('html-basics')">
                    <div class="card-content">
                        <h3 class="assignment-title">HTML and CSS Fundamentals</h3>
                        <p class="assignment-description">Learn the basic concepts of HTML and CSS to create your first web page from scratch.</p>
                        
                        <div class="assignment-meta">
                            <span>Views: 12,450</span>
                            <span class="due-date">89</span>
                        </div>

                        <div class="progress-section">
                            <div class="progress-label">Progress</div>
                            <div class="progress-bar">
                                <div class="progress-fill progress-green" style="width: 90%;"></div>
                            </div>
                        </div>

                        <div class="participants-section">
                            <div class="participant-avatars">
                                <div class="avatar avatar-1">P</div>
                                <div class="avatar avatar-2">C</div>
                                <div class="avatar avatar-3">D</div>
                                <div class="avatar more-avatars">+5</div>
                            </div>
                            <button class="edit-btn" onclick="editAssignment('html-basics', event)">
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Beginner Assignment 2 -->
                <div class="classroom-card" onclick="openAssignment('javascript-intro')">
                    <div class="card-content">
                        <h3 class="assignment-title">Introduction to JavaScript</h3>
                        <p class="assignment-description">Master JavaScript fundamentals and add interactivity to your websites.</p>
                        
                        <div class="assignment-meta">
                            <span>Views: 8,762</span>
                            <span class="due-date">67</span>
                        </div>

                        <div class="progress-section">
                            <div class="progress-label">Progress</div>
                            <div class="progress-bar">
                                <div class="progress-fill progress-blue" style="width: 75%;"></div>
                            </div>
                        </div>

                        <div class="participants-section">
                            <div class="participant-avatars">
                                <div class="avatar avatar-4">E</div>
                                <div class="avatar avatar-5">F</div>
                                <div class="avatar avatar-1">G</div>
                            </div>
                            <button class="edit-btn" onclick="editAssignment('javascript-intro', event)">
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Beginner Assignment 3 -->
                <div class="classroom-card" onclick="openAssignment('responsive-design')">
                    <div class="card-content">
                        <h3 class="assignment-title">Responsive Web Design</h3>
                        <p class="assignment-description">Learn to create websites that adapt perfectly to any device.</p>
                        
                        <div class="assignment-meta">
                            <span>Views: 6,543</span>
                            <span class="due-date">45</span>
                        </div>

                        <div class="progress-section">
                            <div class="progress-label">Progress</div>
                            <div class="progress-bar">
                                <div class="progress-fill progress-orange" style="width: 60%;"></div>
                            </div>
                        </div>

                        <div class="participants-section">
                            <div class="participant-avatars">
                                <div class="avatar avatar-2">H</div>
                                <div class="avatar avatar-4">I</div>
                            </div>
                            <button class="edit-btn" onclick="editAssignment('responsive-design', event)">
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Beginner Assignment 4 -->
                <div class="classroom-card" onclick="openAssignment('ui-fundamentals')">
                    <div class="card-content">
                        <h3 class="assignment-title">UI/UX Fundamentals</h3>
                        <p class="assignment-description">Discover the basic principles of user interface and user experience design.</p>
                        
                        <div class="assignment-meta">
                            <span>Views: 9,821</span>
                            <span class="due-date">78</span>
                        </div>

                        <div class="progress-section">
                            <div class="progress-label">Progress</div>
                            <div class="progress-bar">
                                <div class="progress-fill progress-purple" style="width: 35%;"></div>
                            </div>
                        </div>

                        <div class="participants-section">
                            <div class="participant-avatars">
                                <div class="avatar avatar-5">J</div>
                                <div class="avatar avatar-1">K</div>
                                <div class="avatar avatar-3">L</div>
                                <div class="avatar more-avatars">+3</div>
                            </div>
                            <button class="edit-btn" onclick="editAssignment('ui-fundamentals', event)">
                                <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Offcanvas Trash -->
    <div class="offcanvas-backdrop" id="trashBackdrop" onclick="closeTrash()"></div>
    <div class="offcanvas" id="trashOffcanvas">
        <div class="offcanvas-header">
          <h3 class="offcanvas-title">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="2" fill="currentColor" class="bi bi-trash" viewBox="0 0 16 16">
              <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5m3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0z"/>
              <path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4zM2.5 3h11V2h-11z"/>
            </svg>
            Trash
          </h3>
          <button class="offcanvas-close" onclick="closeTrash()">Ã—</button>
        </div>
        <div class="offcanvas-body" id="trashContent">
            <div class="trash-item">
               
                <div class="trash-item-header">
             
                    <div>
                        <div class="trash-item-title">Old Report 2023</div>
                        <div class="trash-item-date">Deleted: Oct 15, 2024</div>
                    </div>
                </div>
                <div class="trash-item-actions">
                    <button class="trash-btn-small btn-restore" onclick="restoreDocument(101)">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-up-left" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M7.364 3.5a.5.5 0 0 1 .5-.5H14.5A1.5 1.5 0 0 1 16 4.5v10a1.5 1.5 0 0 1-1.5 1.5h-10A1.5 1.5 0 0 1 3 14.5V7.864a.5.5 0 1 1 1 0V14.5a.5.5 0 0 0 .5.5h10a.5.5 0 0 0 .5-.5v-10a.5.5 0 0 0-.5-.5H7.864a.5.5 0 0 1-.5-.5"/>
                        <path fill-rule="evenodd" d="M0 .5A.5.5 0 0 1 .5 0h5a.5.5 0 0 1 0 1H1.707l8.147 8.146a.5.5 0 0 1-.708.708L1 1.707V5.5a.5.5 0 0 1-1 0z"/>
                      </svg>
                      Restore</button>
                    <button class="trash-btn-small btn-delete-permanent" onclick="deletePermanent(101)">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-earmark-x" viewBox="0 0 16 16">
                        <path d="M6.854 7.146a.5.5 0 1 0-.708.708L7.293 9l-1.147 1.146a.5.5 0 0 0 .708.708L8 9.707l1.146 1.147a.5.5 0 0 0 .708-.708L8.707 9l1.147-1.146a.5.5 0 0 0-.708-.708L8 8.293z"/>
                        <path d="M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"/>
                      </svg>
                      Delete Forever
                    </button>
                </div>
            </div>

            <div class="trash-item">
                <div class="trash-item-header">
                    <div>
                        <div class="trash-item-title">Draft Ideas</div>
                        <div class="trash-item-date">Deleted: Oct 12, 2024</div>
                    </div>
                </div>
                <div class="trash-item-actions">
                    <button class="trash-btn-small btn-restore" onclick="restoreDocument(102)">
                       <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-up-left" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M7.364 3.5a.5.5 0 0 1 .5-.5H14.5A1.5 1.5 0 0 1 16 4.5v10a1.5 1.5 0 0 1-1.5 1.5h-10A1.5 1.5 0 0 1 3 14.5V7.864a.5.5 0 1 1 1 0V14.5a.5.5 0 0 0 .5.5h10a.5.5 0 0 0 .5-.5v-10a.5.5 0 0 0-.5-.5H7.864a.5.5 0 0 1-.5-.5"/>
                        <path fill-rule="evenodd" d="M0 .5A.5.5 0 0 1 .5 0h5a.5.5 0 0 1 0 1H1.707l8.147 8.146a.5.5 0 0 1-.708.708L1 1.707V5.5a.5.5 0 0 1-1 0z"/>
                      </svg>
                      Restore
                    </button>
                    <button class="trash-btn-small btn-delete-permanent" onclick="deletePermanent(102)">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-earmark-x" viewBox="0 0 16 16">
                        <path d="M6.854 7.146a.5.5 0 1 0-.708.708L7.293 9l-1.147 1.146a.5.5 0 0 0 .708.708L8 9.707l1.146 1.147a.5.5 0 0 0 .708-.708L8.707 9l1.147-1.146a.5.5 0 0 0-.708-.708L8 8.293z"/>
                        <path d="M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"/>
                      </svg>
                      Delete Forever
                    </button>
                </div>
            </div>

            <div class="trash-item">
                <div class="trash-item-header">
                    <div>
                        <div class="trash-item-title">Marketing Plan 2023</div>
                        <div class="trash-item-date">Deleted: Oct 08, 2024</div>
                    </div>
                </div>
                <div class="trash-item-actions">
                    <button class="trash-btn-small btn-restore" onclick="restoreDocument(103)">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-up-left" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M7.364 3.5a.5.5 0 0 1 .5-.5H14.5A1.5 1.5 0 0 1 16 4.5v10a1.5 1.5 0 0 1-1.5 1.5h-10A1.5 1.5 0 0 1 3 14.5V7.864a.5.5 0 1 1 1 0V14.5a.5.5 0 0 0 .5.5h10a.5.5 0 0 0 .5-.5v-10a.5.5 0 0 0-.5-.5H7.864a.5.5 0 0 1-.5-.5"/>
                        <path fill-rule="evenodd" d="M0 .5A.5.5 0 0 1 .5 0h5a.5.5 0 0 1 0 1H1.707l8.147 8.146a.5.5 0 0 1-.708.708L1 1.707V5.5a.5.5 0 0 1-1 0z"/>
                      </svg>
                      Restore</button>
                    <button class="trash-btn-small btn-delete-permanent" onclick="deletePermanent(103)">
                      <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-file-earmark-x" viewBox="0 0 16 16">
                        <path d="M6.854 7.146a.5.5 0 1 0-.708.708L7.293 9l-1.147 1.146a.5.5 0 0 0 .708.708L8 9.707l1.146 1.147a.5.5 0 0 0 .708-.708L8.707 9l1.147-1.146a.5.5 0 0 0-.708-.708L8 8.293z"/>
                        <path d="M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2M9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"/>
                      </svg>
                      Delete Forever
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Share Modal -->
    <div id="shareModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="hideShareModal()">Ã—</span>
            <h2 style="color:var(--primary)">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-share" viewBox="0 0 16 16">
                <path d="M13.5 1a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3M11 2.5a2.5 2.5 0 1 1 .603 1.628l-6.718 3.12a2.5 2.5 0 0 1 0 1.504l6.718 3.12a2.5 2.5 0 1 1-.488.876l-6.718-3.12a2.5 2.5 0 1 1 0-3.256l6.718-3.12A2.5 2.5 0 0 1 11 2.5m-8.5 4a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3m11 5.5a1.5 1.5 0 1 0 0 3 1.5 1.5 0 0 0 0-3"/>
              </svg>
              Share Document
            </h2>
            
            <form id="shareForm" onsubmit="handleShare(event)">
                <div class="form-group">
                    <label class="form-label">Recipient Email *</label>
                    <input type="email" id="recipientEmail" class="form-control" placeholder="example@email.com" required>
                    <div class="error-text" id="emailError" style="display: none;"></div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Permission Level</label>
                    <select id="permissionLevel" class="form-control">
                        <option value="read">Read Only</option>
                        <option value="write">Read and Write</option>
                        <option value="admin">Administrator</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Message (Optional)</label>
                    <textarea id="shareMessage" class="form-control" rows="3" placeholder="Message for recipient..."></textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Expires In (Days)</label>
                    <select id="expirationDays" class="form-control">
                        <option value="1">1 day</option>
                        <option value="3">3 days</option>
                        <option value="7" selected>7 days</option>
                        <option value="30">30 days</option>
                        <option value="90">90 days</option>
                    </select>
                </div>
                
                <div style="display: flex; gap: 1rem; justify-content: flex-end; margin-top: 2rem;">
                    <button type="button" class="btn btn-secondary" onclick="hideShareModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="shareSubmitBtn">
                        <span class="loading" id="shareLoading" style="display: none;"></span>
                        ðŸ”— Share
                    </button>
                </div>
            </form>
        </div>
    </div>

  <script>
    // Existing sidebar functionality
const expand_btn = document.querySelector(".expand-btn");
let activeIndex;

expand_btn.addEventListener("click", () => {
    document.body.classList.toggle("collapsed");
});

const current = window.location.href;
const allLinks = document.querySelectorAll(".sidebar-links a");

allLinks.forEach((elem) => {
    elem.addEventListener("click", function () {
    const hrefLinkClick = elem.href;
    allLinks.forEach((link) => {
        if (link.href == hrefLinkClick) {
        link.classList.add("active");
        } else {
        link.classList.remove("active");
        }
    });
    });
});

    // Variables globales
let currentDocumentId = null;
let currentShareDocId = null;
let currentUserEmail = 'anonymous';
let isSharedDocument = false;
let sharedDocumentInfo = null;
let documents = [];

// Cargar email del usuario
function loadUserEmail() {
    currentUserEmail = localStorage.getItem('userEmail') || prompt('Ingresa tu email:') || 'anonymous';
    if (currentUserEmail !== 'anonymous') {
        localStorage.setItem('userEmail', currentUserEmail);
    }
}

// Funciones de utilidad
function formatBytes(bytes) {
    if (bytes === 0) return '0 Bytes';
    const k = 1024;
    const sizes = ['Bytes', 'KB', 'MB', 'GB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
}

function formatDate(dateString) {
    const date = new Date(dateString);
    return date.toLocaleDateString('es-ES', {
        day: '2-digit',
        month: '2-digit',
        year: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
    });
}

function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

// Toggle dropdown menu
function toggleDropdown(event, docId) {
    event.stopPropagation();
    
    // Cerrar todos los otros dropdowns
    document.querySelectorAll('.dropdown-menu').forEach(menu => {
        if (menu.id !== `dropdown-${docId}`) {
            menu.classList.remove('show');
        }
    });
    
    const dropdown = document.getElementById(`dropdown-${docId}`);
    if (dropdown) {
        dropdown.classList.toggle('show');
    }
}

// Cerrar dropdowns al hacer clic fuera
document.addEventListener('click', function(event) {
    if (!event.target.closest('.file-menu-btn') && !event.target.closest('.dropdown-menu')) {
        document.querySelectorAll('.dropdown-menu').forEach(menu => {
            menu.classList.remove('show');
        });
    }
});

// Funciones del Trash
function openTrash() {
    const offcanvas = document.getElementById('trashOffcanvas');
    const backdrop = document.getElementById('trashBackdrop');
    if (offcanvas && backdrop) {
        offcanvas.classList.add('show');
        backdrop.classList.add('show');
    }
}

function closeTrash() {
    const offcanvas = document.getElementById('trashOffcanvas');
    const backdrop = document.getElementById('trashBackdrop');
    if (offcanvas && backdrop) {
        offcanvas.classList.remove('show');
        backdrop.classList.remove('show');
    }
}

function restoreDocument(docId) {
    showNotification(`Document restored successfully!`, 'success');
    // TODO: Implementar lÃ³gica de restauraciÃ³n
}

function deletePermanent(docId) {
    if (confirm('Are you sure you want to permanently delete this document? This action cannot be undone.')) {
        showNotification(`Document permanently deleted`, 'info');
        // TODO: Implementar lÃ³gica de eliminaciÃ³n permanente
    }
}

// Funciones del modal de compartir
function showShareModal(docId) {
    if (event) event.stopPropagation();
    currentShareDocId = docId;
    const modal = document.getElementById('shareModal');
    if (modal) {
        modal.classList.add('show');
        const emailInput = document.getElementById('recipientEmail');
        if (emailInput) emailInput.focus();
    }
}

function hideShareModal() {
    const modal = document.getElementById('shareModal');
    const form = document.getElementById('shareForm');
    const errorDiv = document.getElementById('emailError');
    
    if (modal) modal.classList.remove('show');
    if (form) form.reset();
    if (errorDiv) errorDiv.style.display = 'none';
    currentShareDocId = null;
}

function validateEmail(email) {
    const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    return re.test(email);
}

function handleShare(event) {
    event.preventDefault();
    
    const emailInput = document.getElementById('recipientEmail');
    const errorDiv = document.getElementById('emailError');
    const submitBtn = document.getElementById('shareSubmitBtn');
    const loading = document.getElementById('shareLoading');
    
    if (!emailInput || !errorDiv || !submitBtn || !loading) {
        console.error('Required elements not found');
        return;
    }
    
    const email = emailInput.value;
    
    // Validar email
    if (!validateEmail(email)) {
        errorDiv.textContent = 'Please enter a valid email address';
        errorDiv.style.display = 'block';
        return;
    }
    
    errorDiv.style.display = 'none';
    
    // Mostrar loading
    loading.style.display = 'inline-block';
    submitBtn.disabled = true;
    
    // Simular llamada API
    setTimeout(() => {
        const permission = document.getElementById('permissionLevel')?.value || 'read';
        const message = document.getElementById('shareMessage')?.value || '';
        const expires = document.getElementById('expirationDays')?.value || '7';
        
        console.log('Sharing document:', {
            docId: currentShareDocId,
            email,
            permission,
            message,
            expires
        });
        
        loading.style.display = 'none';
        submitBtn.disabled = false;
        
        showNotification(`Document shared with ${email}!`, 'success');
        hideShareModal();
    }, 1500);
}

// Cargar lista de documentos
async function loadDocumentsList() {
    try {
        const response = await fetch(`/document_bp/api/documents?owner_email=${currentUserEmail}&per_page=50`);
        
        if (!response.ok) {
            throw new Error('Error cargando lista de documentos');
        }
        
        const data = await response.json();
        documents = data.documents || [];
        
        renderDocumentsList();
    } catch (error) {
        console.error('Error loading documents:', error);
        showNotification('Error loading documents. Showing demo data.', 'warning');
    }
}


        function renderDocumentsList() {
            const container = document.getElementById('documentsListContainer');
            
 
            
            const html = documents.map(doc => `<div class="file-card" onclick="loadDocument(${doc.id})">
               <button class="file-menu-btn" onclick="toggleDropdown(event, 1)">
                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"/>
                    </svg>
                </button>
                <div class="dropdown-menu" id="dropdown-1">
                    <button class="dropdown-item" onclick="editDocument(1)">
                        <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
                        </svg>
                        Edit
                    </button>
                    <button class="dropdown-item" onclick="showShareModal(1)">
                        <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"/>
                        </svg>
                        Share
                    </button>
                    <button class="dropdown-item danger" onclick="deleteDocument(1)">
                        <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
                        </svg>
                        Delete
                    </button>
                </div>
                <div class="file-icon-large app-icon " style="color:white;">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-filetype-docx" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M14 4.5V11h-1V4.5h-2A1.5 1.5 0 0 1 9.5 3V1H4a1 1 0 0 0-1 1v9H2V2a2 2 0 0 1 2-2h5.5zm-6.839 9.688v-.522a1.5 1.5 0 0 0-.117-.641.86.86 0 0 0-.322-.387.86.86 0 0 0-.469-.129.87.87 0 0 0-.471.13.87.87 0 0 0-.32.386 1.5 1.5 0 0 0-.117.641v.522q0 .384.117.641a.87.87 0 0 0 .32.387.9.9 0 0 0 .471.126.9.9 0 0 0 .469-.126.86.86 0 0 0 .322-.386 1.55 1.55 0 0 0 .117-.642m.803-.516v.513q0 .563-.205.973a1.47 1.47 0 0 1-.589.627q-.381.216-.917.216a1.86 1.86 0 0 1-.92-.216 1.46 1.46 0 0 1-.589-.627 2.15 2.15 0 0 1-.205-.973v-.513q0-.569.205-.975.205-.411.59-.627.386-.22.92-.22.535 0 .916.22.383.219.59.63.204.406.204.972M1 15.925v-3.999h1.459q.609 0 1.005.235.396.233.589.68.196.445.196 1.074 0 .634-.196 1.084-.197.451-.595.689-.396.237-.999.237zm1.354-3.354H1.79v2.707h.563q.277 0 .483-.082a.8.8 0 0 0 .334-.252q.132-.17.196-.422a2.3 2.3 0 0 0 .068-.592q0-.45-.118-.753a.9.9 0 0 0-.354-.454q-.237-.152-.61-.152Zm6.756 1.116q0-.373.103-.633a.87.87 0 0 1 .301-.398.8.8 0 0 1 .475-.138q.225 0 .398.097a.7.7 0 0 1 .273.26.85.85 0 0 1 .12.381h.765v-.073a1.33 1.33 0 0 0-.466-.964 1.4 1.4 0 0 0-.49-.272 1.8 1.8 0 0 0-.606-.097q-.534 0-.911.223-.375.222-.571.633-.197.41-.197.978v.498q0 .568.194.976.195.406.571.627.375.216.914.216.44 0 .785-.164t.551-.454a1.27 1.27 0 0 0 .226-.674v-.076h-.765a.8.8 0 0 1-.117.364.7.7 0 0 1-.273.248.9.9 0 0 1-.401.088.85.85 0 0 1-.478-.131.83.83 0 0 1-.298-.393 1.7 1.7 0 0 1-.103-.627zm5.092-1.76h.894l-1.275 2.006 1.254 1.992h-.908l-.85-1.415h-.035l-.852 1.415h-.862l1.24-2.015-1.228-1.984h.932l.832 1.439h.035z"/>
                  </svg>
                </div>
                <p class="file-name">${escapeHtml(doc.title)}</p>
                <p class="file-size">${formatDate(doc.updated_at)}</p>
                <p class="file-size">${formatBytes(doc.size_bytes)}</p>
            </div> `).join('');

            container.innerHTML = html;
        }

// Verificar documento compartido
function checkForSharedDocument() {
    const urlParams = new URLSearchParams(window.location.search);
    const sharedToken = urlParams.get('shared_token');
    const docId = urlParams.get('doc_id');
    const permission = urlParams.get('permission');
    
    if (sharedToken && docId) {
        isSharedDocument = true;
        loadSharedDocument(sharedToken);
        
        if (permission === 'read') {
            showReadonlyBanner();
        }
    }
}

        async function loadDocument(docId) {
            try {
                showLoading('Cargando documento...');
                
                const response = await fetch(`/document_bp/api/document/${docId}/load?user_email=${currentUserEmail}`);
                
                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error || 'Error cargando documento');
                }
                
                const data = await response.json();
                
                currentDocumentId = docId;
                document.getElementById('documentTitle').value = data.title;
                
                if (data.delta && data.delta.ops) {
                    quill.setContents(data.delta);
                } else {
                    quill.setContents([]);
                }
                
                updateStatus('saved', 'Documento cargado');
                updateDocumentInfo(data);
                hideLoading();
                
                // Actualizar lista activa
                updateActiveDocument(docId);
                
            } catch (error) {
                console.error('Error:', error);
                hideLoading();
                showNotification(error.message, 'error');
            }
        }


async function loadSharedDocument(token) {
    try {
        showLoading('Cargando documento compartido...');
        
        const response = await fetch(`/share_bp/api/shared-document/${token}`);
        const data = await response.json();
        
        if (!response.ok) {
            throw new Error(data.error || 'Error cargando documento compartido');
        }
        
        currentDocumentId = data.id;
        sharedDocumentInfo = data.share_info;
        
        hideLoading();
        showNotification(`Documento compartido por ${data.share_info?.shared_by || 'usuario'}`, 'info');
        
    } catch (error) {
        console.error('Error:', error);
        hideLoading();
        showNotification(error.message, 'error');
    }
}

// Funciones de loading (placeholders)
function showLoading(message) {
    console.log('Loading:', message);
    showNotification(message, 'info');
}

function hideLoading() {
    console.log('Loading complete');
}

function showReadonlyBanner() {
    console.log('Document is read-only');
}

// Funciones de documentos
function editDocument(docId, event) {
    if (event) event.stopPropagation();
    showNotification(`Opening editor for document ${docId}...`, 'info');
    setTimeout(() => {
        window.location.href = `/editor?doc=${docId}`;
    }, 500);
}

function deleteDocument(docId, event) {
    if (event) event.stopPropagation();
    if (confirm('Are you sure you want to move this document to trash?')) {
        showNotification(`Document moved to trash`, 'info');
        // TODO: Implementar lÃ³gica de eliminaciÃ³n
    }
}

function loadDocument(docId) {
    console.log('Loading document:', docId);
    showNotification(`Loading document ${docId}...`, 'info');
    // Redirigir al editor con el ID del documento
    window.location.href = `/editor?doc=${docId}`;
}

function createNewDocument() {
    showNotification('Creating new document...', 'info');
    setTimeout(() => {
        window.location.href = '/editor';
    }, 500);
}

function handleUpload() {
    const btn = document.querySelector('.upload-btn');
    if (!btn) return;
    
    const originalContent = btn.innerHTML;
    
    btn.innerHTML = `
        <svg width="16" height="16" class="animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <circle cx="12" cy="12" r="10" stroke-width="2" fill="none" stroke-dasharray="31.4" stroke-dashoffset="10"/>
        </svg>
        Uploading...
    `;
    btn.style.pointerEvents = 'none';
    
    setTimeout(() => {
        btn.innerHTML = originalContent;
        btn.style.pointerEvents = 'auto';
        showNotification('Upload feature coming soon!', 'info');
    }, 2000);
}

function openAssignment(assignmentId) {
    showNotification(`Opening assignment: ${assignmentId}`, 'info');
}

function editAssignment(assignmentId, event) {
    event.stopPropagation();
    showNotification(`Editing assignment: ${assignmentId}`, 'warning');
}

// Sistema de notificaciones
function showNotification(message, type = 'info') {
    const existingNotifications = document.querySelectorAll('.notification');
    existingNotifications.forEach(notification => notification.remove());

    const notification = document.createElement('div');
    notification.className = 'notification';
    
    const colors = {
        success: '#10b981',
        error: '#ef4444',
        info: '#1621ff',
        warning: '#f59e0b'
    };
    
    notification.style.cssText = `
        position: fixed;
        top: 2rem;
        right: 2rem;
        background: ${colors[type] || colors.info};
        color: white;
        padding: 1rem 1.5rem;
        border-radius: 0.5rem;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        z-index: 3000;
        transform: translateX(100%);
        transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        font-weight: 500;
        font-size: 0.9rem;
        max-width: 300px;
    `;
    
    notification.textContent = message;
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.style.transform = 'translateX(0)';
    }, 100);
    
    setTimeout(() => {
        notification.style.transform = 'translateX(100%)';
        setTimeout(() => {
            if (notification.parentNode) {
                notification.remove();
            }
        }, 300);
    }, 3000);
}

// InicializaciÃ³n
document.addEventListener('DOMContentLoaded', function() {
    console.log('MarkTrack initialized');
    
    // Cargar email y documentos
    loadUserEmail();
    checkForSharedDocument();
    loadDocumentsList();
    
    // Configurar observador de intersecciÃ³n para animaciones
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    }, observerOptions);

    document.querySelectorAll('.shared-section').forEach(section => {
        observer.observe(section);
    });

    // Agregar efectos ripple a las tarjetas interactivas
    document.querySelectorAll('.file-card, .classroom-card').forEach(card => {
        card.addEventListener('click', function(e) {
            if (e.target.closest('.edit-btn') || e.target.closest('.file-menu-btn')) return;
            
            const ripple = document.createElement('div');
            const rect = this.getBoundingClientRect();
            const size = Math.max(rect.width, rect.height);
            const x = e.clientX - rect.left - size / 2;
            const y = e.clientY - rect.top - size / 2;
            
            ripple.style.cssText = `
                position: absolute;
                border-radius: 50%;
                background: rgba(22, 33, 255, 0.1);
                transform: scale(0);
                animation: ripple 0.6s cubic-bezier(0.4, 0, 0.2, 1);
                width: ${size}px;
                height: ${size}px;
                left: ${x}px;
                top: ${y}px;
                pointer-events: none;
                z-index: 10;
            `;
            
            this.style.position = 'relative';
            this.appendChild(ripple);
            
            setTimeout(() => {
                if (ripple.parentNode) {
                    ripple.remove();
                }
            }, 600);
        });
    });

    // Agregar CSS para animaciones
    const style = document.createElement('style');
    style.textContent = `
        @keyframes ripple {
            to {
                transform: scale(4);
                opacity: 0;
            }
        }
        
        .classroom-card, .file-card {
            position: relative;
            overflow: hidden;
        }
        
        .animate-spin {
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            from {
                transform: rotate(0deg);
            }
            to {
                transform: rotate(360deg);
            }
        }
    `;
    document.head.appendChild(style);
});

// Atajos de teclado
document.addEventListener('keydown', function(e) {
    // Cerrar modales con Escape
    if (e.key === 'Escape') {
        hideShareModal();
        closeTrash();
        
        // Cerrar todas las notificaciones
        const notifications = document.querySelectorAll('.notification');
        notifications.forEach(notification => {
            notification.style.transform = 'translateX(100%)';
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 300);
        });
    }
    
    // Ctrl/Cmd + U para upload
    if ((e.ctrlKey || e.metaKey) && e.key === 'u') {
        e.preventDefault();
        handleUpload();
    }
    
    // Ctrl/Cmd + N para nuevo documento
    if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
        e.preventDefault();
        createNewDocument();
    }
});

// Scroll suave
document.documentElement.style.scrollBehavior = 'smooth';
  </script>
</body>
</html>



